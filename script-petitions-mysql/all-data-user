SELECT 
    u.id_user AS 'ID usuario',
    u.name AS 'Nombre',
    u.surname AS 'Apellido',
    u.email AS 'Correo electrónico',
    u.rol AS 'Rol',
    w.name AS 'Nombre almacén',
    t.plate AS 'Placa camión'
FROM 
    user u
JOIN 
    warehouse w ON u.asigned_id_warehouse = w.id_warehouse
LEFT JOIN 
    truck t ON u.id_user = t.driver_id_user;

/* Si se quiere pedir un id en concreto

 WHERE 
    u.id_user = 3; */


/* Para exportar en formato JSON */

SELECT JSON_OBJECT(
    'ID_user', u.id_user,
    'Name', u.name,
    'Surname', u.surname,
    'Email', u.email,
    'Rol', u.rol,
    'Wharehouse', JSON_OBJECT(
        'ID_wharehouse', w.id_warehouse,
        'Wharehouse_name', w.name,
        'Locality', w.locality,
        'Adress', w.adress
    ),
    'Truck', IFNULL(
        JSON_OBJECT(
            'ID_Truck', t.id_truck,
            'Plate', t.plate
        ), 
        ''
    )
) AS User
FROM 
    user u
JOIN 
    warehouse w ON u.asigned_id_warehouse = w.id_warehouse
LEFT JOIN 
    truck t ON u.id_user = t.driver_id_user;